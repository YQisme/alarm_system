# YOLO ç›®æ ‡æ£€æµ‹ä¸ŽåŒºåŸŸæŠ¥è­¦ç³»ç»Ÿ

åŸºäºŽ YOLO çš„å®žæ—¶ç›®æ ‡æ£€æµ‹ç³»ç»Ÿï¼Œæ”¯æŒ80ä¸ªCOCOç±»åˆ«æ£€æµ‹ï¼Œæ”¯æŒè‡ªå®šä¹‰å¤šè¾¹å½¢ç›‘æŽ§åŒºåŸŸï¼Œå½“ç›®æ ‡è¿›å…¥æŒ‡å®šåŒºåŸŸæ—¶è‡ªåŠ¨è§¦å‘æŠ¥è­¦ã€‚é‡‡ç”¨å‰åŽç«¯åˆ†ç¦»æž¶æž„ï¼ˆBSæž¶æž„ï¼‰ï¼Œæä¾› Web ç•Œé¢è¿›è¡Œå¯è§†åŒ–æ“ä½œã€‚

**ä¸»è¦ç‰¹æ€§**ï¼š
- ðŸŽ¯ æ”¯æŒå¤šç±»åˆ«ç›®æ ‡æ£€æµ‹ï¼ˆäººã€è½¦ã€åŠ¨ç‰©ç­‰80ä¸ªç±»åˆ«ï¼‰
- ðŸ”„ æ”¯æŒåŠ¨æ€åˆ‡æ¢æ¨¡åž‹å’Œè§†é¢‘æº
- âš™ï¸ æ”¯æŒç±»åˆ«é€‰æ‹©ã€è‡ªå®šä¹‰åç§°ã€ç½®ä¿¡åº¦è®¾ç½®
- ðŸŽ¨ æ”¯æŒæ˜¾ç¤ºæ ·å¼å®šåˆ¶ï¼ˆå­—ä½“ã€é¢œè‰²ã€ä¸­è‹±æ–‡åˆ‡æ¢ï¼‰
- ðŸ“‹ æ”¯æŒæ¨¡åž‹ç±»åˆ«æ˜ å°„é…ç½®
- ðŸ–¥ï¸ è‡ªåŠ¨GPUæ£€æµ‹ï¼Œæ— GPUæ—¶è‡ªåŠ¨ä½¿ç”¨CPU
- ðŸ“Š å®žæ—¶æ˜¾ç¤ºå¸§çŽ‡å’Œåˆ†è¾¨çŽ‡
- ðŸ“ æ—¥å¿—ç³»ç»Ÿï¼ˆåŽç«¯æ—¥å¿—å’ŒYOLOæŽ¨ç†æ—¥å¿—åˆ†ç¦»ï¼Œå‰ç«¯å®žæ—¶æŸ¥çœ‹ï¼‰
- ðŸ”” çµæ´»çš„æŠ¥è­¦é…ç½®ï¼ˆé˜²æŠ–æ—¶é—´ã€æ£€æµ‹æ¨¡å¼ã€ç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡ï¼‰

## åŠŸèƒ½ç‰¹æ€§

- ðŸŽ¯ **å®žæ—¶ç›®æ ‡æ£€æµ‹**ï¼šåŸºäºŽ YOLO æ¨¡åž‹è¿›è¡Œå®žæ—¶ç›®æ ‡è·Ÿè¸ªæ£€æµ‹ï¼ˆæ”¯æŒ80ä¸ªCOCOç±»åˆ«ï¼‰
- ðŸ“ **è‡ªå®šä¹‰ç›‘æŽ§åŒºåŸŸ**ï¼šæ”¯æŒåœ¨è§†é¢‘ç”»é¢ä¸Šç»˜åˆ¶å¤šè¾¹å½¢ç›‘æŽ§åŒºåŸŸ
- ðŸ”” **æ™ºèƒ½æŠ¥è­¦**ï¼šå½“æ£€æµ‹åˆ°ç›®æ ‡è¿›å…¥ç›‘æŽ§åŒºåŸŸæ—¶è‡ªåŠ¨è§¦å‘æŠ¥è­¦
- ðŸ–±ï¸ **äº¤äº’å¼ç»˜åˆ¶**ï¼šé¼ æ ‡ç‚¹å‡»ç»˜åˆ¶ï¼Œæ”¯æŒé¦–å°¾å¸é™„åŠŸèƒ½ï¼Œä¾¿äºŽç²¾ç¡®é—­åˆ
- ðŸ’¾ **é…ç½®æŒä¹…åŒ–**ï¼šæ‰€æœ‰é…ç½®è‡ªåŠ¨ä¿å­˜ï¼Œé‡å¯åŽè‡ªåŠ¨åŠ è½½
- ðŸ“Š **å®žæ—¶ä¿¡æ¯æ˜¾ç¤º**ï¼šæ˜¾ç¤ºæ£€æµ‹åˆ°çš„ç›®æ ‡ä¿¡æ¯å’ŒæŠ¥è­¦è®°å½•
- ðŸŒ **Web ç•Œé¢**ï¼šåŸºäºŽ Web çš„å‰ç«¯ç•Œé¢ï¼Œæ”¯æŒè·¨å¹³å°è®¿é—®
- ðŸŽ¨ **æ¨¡åž‹ç®¡ç†**ï¼šæ”¯æŒåŠ¨æ€åˆ‡æ¢ä¸åŒçš„YOLOæ¨¡åž‹
- ðŸ“¹ **è§†é¢‘æºç®¡ç†**ï¼šæ”¯æŒåŠ¨æ€åˆ‡æ¢RTSPã€æœ¬åœ°è§†é¢‘æ–‡ä»¶ç­‰è§†é¢‘æº
- ðŸ·ï¸ **ç±»åˆ«ç®¡ç†**ï¼šå¯é€‰æ‹©æ£€æµ‹çš„ç±»åˆ«ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸­æ–‡åç§°
- âš™ï¸ **ç½®ä¿¡åº¦è®¾ç½®**ï¼šä¸ºæ¯ä¸ªç±»åˆ«å•ç‹¬è®¾ç½®ç½®ä¿¡åº¦é˜ˆå€¼
- ðŸŽ¨ **æ˜¾ç¤ºå®šåˆ¶**ï¼šè‡ªå®šä¹‰å­—ä½“å¤§å°ã€è¾¹æ¡†é¢œè‰²ã€æ–‡å­—é¢œè‰²ç­‰æ˜¾ç¤ºæ ·å¼
- ðŸŒ **ä¸­è‹±æ–‡åˆ‡æ¢**ï¼šæ”¯æŒä¸­æ–‡å’Œè‹±æ–‡æ˜¾ç¤ºåˆ‡æ¢ï¼Œè‹±æ–‡æ¨¡å¼æ€§èƒ½æ›´ä¼˜
- ðŸ“‹ **æ¨¡åž‹ç±»åˆ«æ˜ å°„**ï¼šæ¯ä¸ªæ¨¡åž‹å¯é…ç½®ç‹¬ç«‹çš„ç±»åˆ«æ˜ å°„ï¼ˆæ”¯æŒä¸åŒæ•°æ®é›†ï¼‰
- ðŸ–¥ï¸ **GPUè‡ªåŠ¨æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹GPUå¯ç”¨æ€§ï¼Œæ— GPUæ—¶è‡ªåŠ¨ä½¿ç”¨CPUæ¨¡å¼
- ðŸ“Š **æ€§èƒ½ç›‘æŽ§**ï¼šå®žæ—¶æ˜¾ç¤ºè§†é¢‘å¸§çŽ‡å’Œåˆ†è¾¨çŽ‡ä¿¡æ¯
- ðŸ“ **æ—¥å¿—ç³»ç»Ÿ**ï¼šåŽç«¯æ—¥å¿—å’ŒYOLOæŽ¨ç†æ—¥å¿—åˆ†ç¦»ä¿å­˜ï¼Œå‰ç«¯å®žæ—¶æŸ¥çœ‹
- ðŸ”” **æŠ¥è­¦é…ç½®**ï¼šå¯é…ç½®é˜²æŠ–æ—¶é—´ã€æ£€æµ‹æ¨¡å¼ï¼ˆä¸­å¿ƒç‚¹/è¾¹æ¡†ï¼‰ã€ç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡

## æŠ€æœ¯æ ˆ

### åŽç«¯
- **Flask**ï¼šWeb æ¡†æž¶
- **Flask-SocketIO**ï¼šWebSocket å®žæ—¶é€šä¿¡
- **Ultralytics YOLO**ï¼šç›®æ ‡æ£€æµ‹æ¨¡åž‹
- **OpenCV**ï¼šè§†é¢‘å¤„ç†å’Œå›¾åƒå¤„ç†
- **NumPy**ï¼šæ•°å€¼è®¡ç®—
- **Pillow (PIL)**ï¼šå›¾åƒå¤„ç†å’Œä¸­æ–‡æ–‡å­—æ¸²æŸ“

### å‰ç«¯
- **HTML5 Canvas**ï¼šè§†é¢‘æ˜¾ç¤ºå’Œå›¾å½¢ç»˜åˆ¶
- **Socket.IO Client**ï¼šWebSocket å®¢æˆ·ç«¯
- **åŽŸç”Ÿ JavaScript**ï¼šå‰ç«¯é€»è¾‘å®žçŽ°

## ç³»ç»Ÿè¦æ±‚

- Python 3.10+
- CUDA æ”¯æŒçš„ GPUï¼ˆæŽ¨èï¼Œç”¨äºŽåŠ é€Ÿ YOLO æŽ¨ç†ï¼‰
- æ”¯æŒ RTSP çš„è§†é¢‘æºæˆ–æœ¬åœ°è§†é¢‘æ–‡ä»¶

## å®‰è£…æ­¥éª¤

### 1. å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®

```bash
cd /home/nvidia/yzkj
```

### 2. å®‰è£… Python ä¾èµ–

```bash
pip install -r requirements.txt
```

**æ³¨æ„**ï¼šå¦‚æžœé‡åˆ° NumPy ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼ˆå¦‚ `AttributeError: _ARRAY_API not found`ï¼‰ï¼Œè¯·ç¡®ä¿ä½¿ç”¨ NumPy 1.x ç‰ˆæœ¬ï¼š

```bash
pip install "numpy>=1.24.0,<2.0.0"
```

### 3. å‡†å¤‡ YOLO æ¨¡åž‹

ç¡®ä¿é¡¹ç›®ç›®å½•ä¸­çš„ `models/` æ–‡ä»¶å¤¹ä¸‹æœ‰ YOLO æ¨¡åž‹æ–‡ä»¶ï¼Œæ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š
- `.pt` (PyTorch æ¨¡åž‹)
- `.onnx` (ONNX æ¨¡åž‹)
- `.engine` (TensorRT å¼•æ“Ž)

é»˜è®¤ä½¿ç”¨ `yolo26m_640_int8.engine`ï¼Œå¯åœ¨å‰ç«¯ç•Œé¢ä¸­åˆ‡æ¢ã€‚

### 4. é…ç½®è§†é¢‘æºï¼ˆå¯é€‰ï¼‰

é»˜è®¤è§†é¢‘æºå¯åœ¨ `backend/server.py` ä¸­ä¿®æ”¹ï¼Œæˆ–åœ¨å‰ç«¯ç•Œé¢ä¸­åŠ¨æ€è®¾ç½®ï¼š

```python
video_path = "rtsp://admin:scyzkj123456@192.168.1.2:554/h264/ch1/main/av_stream"
```

æ”¯æŒï¼š
- RTSP æµï¼š`rtsp://username:password@ip:port/path`
- æœ¬åœ°è§†é¢‘æ–‡ä»¶ï¼š`/path/to/video.mp4`
- æ‘„åƒå¤´ï¼š`0` æˆ– `1`ï¼ˆæ‘„åƒå¤´ç´¢å¼•ï¼‰

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡

**æ–¹å¼ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæŽ¨èï¼‰**

```bash
./start_server.sh
```

**æ–¹å¼äºŒï¼šç›´æŽ¥è¿è¡Œ**

```bash
python3 backend/server.py
```

### è®¿é—® Web ç•Œé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š

```
http://localhost:5000
```

å¦‚æžœæœåŠ¡å™¨è¿è¡Œåœ¨å…¶ä»–æœºå™¨ä¸Šï¼Œè¯·ä½¿ç”¨å¯¹åº”çš„ IP åœ°å€ï¼š

```
http://<æœåŠ¡å™¨IP>:5000
```

### æ“ä½œè¯´æ˜Ž

#### 1. ç³»ç»Ÿé…ç½®

ç‚¹å‡»é¡µé¢é¡¶éƒ¨çš„ **"ç³»ç»Ÿé…ç½®"** é¢æ¿ï¼Œå¯ä»¥é…ç½®ï¼š

- **æ£€æµ‹æ¨¡åž‹**ï¼šä»Žä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©è¦ä½¿ç”¨çš„YOLOæ¨¡åž‹ï¼Œç‚¹å‡»"åº”ç”¨"åˆ‡æ¢
- **è§†é¢‘URL**ï¼šè¾“å…¥æ–°çš„è§†é¢‘æºåœ°å€ï¼Œç‚¹å‡»"åº”ç”¨"åˆ‡æ¢è§†é¢‘æº
- **æ£€æµ‹ç±»åˆ«**ï¼š
  - å‹¾é€‰è¦æ£€æµ‹çš„ç±»åˆ«ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
  - ä¸ºæ¯ä¸ªç±»åˆ«è®¾ç½®è‡ªå®šä¹‰ä¸­æ–‡åç§°
  - ä¸ºæ¯ä¸ªç±»åˆ«è®¾ç½®ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆ0-1ä¹‹é—´ï¼‰
  - ç‚¹å‡»"å…¨é€‰"/"å…¨ä¸é€‰"å¿«é€Ÿæ“ä½œ
  - ç‚¹å‡»"åº”ç”¨"ä½¿é…ç½®ç”Ÿæ•ˆ
- **æ˜¾ç¤ºè®¾ç½®**ï¼š
  - å­—ä½“å¤§å°ï¼š8-72åƒç´ 
  - è¾¹æ¡†ç²—ç»†ï¼š1-10åƒç´ 
  - è¾¹æ¡†é¢œè‰²ï¼šä½¿ç”¨é¢œè‰²é€‰æ‹©å™¨æˆ–è¾“å…¥RGBå€¼ï¼ˆå¦‚ï¼š0,255,0ï¼‰
  - æ–‡å­—é¢œè‰²ï¼šè®¾ç½®æ£€æµ‹æ ‡ç­¾çš„æ–‡å­—é¢œè‰²
  - æ˜¾ç¤ºè¯­è¨€ï¼šåˆ‡æ¢ä¸­æ–‡/è‹±æ–‡æ˜¾ç¤ºï¼ˆè‹±æ–‡æ¨¡å¼æ€§èƒ½æ›´å¥½ï¼‰
  - ç‚¹å‡»"åº”ç”¨æ˜¾ç¤ºè®¾ç½®"ä½¿é…ç½®ç”Ÿæ•ˆ
- **æŠ¥è­¦è®¾ç½®**ï¼š
  - é˜²æŠ–æ—¶é—´ï¼ˆç§’ï¼‰ï¼šè®¾ç½®åŒä¸€ç›®æ ‡åœ¨å¤šå°‘ç§’å†…åªæŠ¥è­¦ä¸€æ¬¡ï¼ˆ0-300ç§’ï¼Œ0è¡¨ç¤ºä¸é˜²æŠ–ï¼‰
  - æ£€æµ‹æ¨¡å¼ï¼š
    - ä¸­å¿ƒç‚¹æ¨¡å¼ï¼šæ£€æµ‹æ¡†ä¸­å¿ƒç‚¹è¿›å…¥åŒºåŸŸæ—¶æ‰æŠ¥è­¦ï¼ˆæ›´ä¸¥æ ¼ï¼‰
    - è¾¹æ¡†æ¨¡å¼ï¼šæ£€æµ‹æ¡†ä»»æ„ç‚¹è¿›å…¥åŒºåŸŸå³æŠ¥è­¦ï¼ˆæ›´æ•æ„Ÿï¼‰
  - ç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡ï¼šå¯ç”¨åŽï¼ŒåŒä¸€IDåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªæŠ¥è­¦ä¸€æ¬¡ï¼ˆå³ä½¿ç¦»å¼€åŽå†æ¬¡è¿›å…¥ä¹Ÿä¸æŠ¥è­¦ï¼‰
  - ç‚¹å‡»"åº”ç”¨æŠ¥è­¦è®¾ç½®"ä½¿é…ç½®ç”Ÿæ•ˆ

#### 2. ç»˜åˆ¶ç›‘æŽ§åŒºåŸŸ

1. ç‚¹å‡» **"ç»˜åˆ¶ç›‘æŽ§åŒºåŸŸ"** æŒ‰é’®
2. åœ¨è§†é¢‘ç”»é¢ä¸Šç”¨é¼ æ ‡å·¦é”®ç‚¹å‡»ï¼Œæ·»åŠ å¤šè¾¹å½¢é¡¶ç‚¹
3. å½“é¼ æ ‡æŽ¥è¿‘èµ·ç‚¹æ—¶ï¼Œä¼šè‡ªåŠ¨å¸é™„å¹¶æ˜¾ç¤ºé‡‘è‰²é«˜äº®
4. ç‚¹å‡»å¸é™„ç‚¹æˆ–åŒå‡»å®Œæˆç»˜åˆ¶
5. å¤šè¾¹å½¢ä¼šè‡ªåŠ¨ä¿å­˜åˆ°é…ç½®æ–‡ä»¶

**æç¤º**ï¼š
- è‡³å°‘éœ€è¦ 3 ä¸ªé¡¶ç‚¹æ‰èƒ½å½¢æˆå¤šè¾¹å½¢
- æŒ‰ `ESC` é”®å¯ä»¥å–æ¶ˆç»˜åˆ¶
- åŒå‡»å¯ä»¥å®Œæˆç»˜åˆ¶

#### 3. ç®¡ç†ç›‘æŽ§åŒºåŸŸ

- **ä¿å­˜åŒºåŸŸ**ï¼šç»˜åˆ¶å®ŒæˆåŽä¼šè‡ªåŠ¨ä¿å­˜ï¼Œä¹Ÿå¯ç‚¹å‡»"ä¿å­˜åŒºåŸŸ"æŒ‰é’®æ‰‹åŠ¨ä¿å­˜
- **æ¸…é™¤åŒºåŸŸ**ï¼šç‚¹å‡»"æ¸…é™¤åŒºåŸŸ"æŒ‰é’®å¯ä»¥åˆ é™¤å½“å‰è®¾ç½®çš„ç›‘æŽ§åŒºåŸŸ

#### 4. æŸ¥çœ‹æŠ¥è­¦ä¿¡æ¯

- å½“æ£€æµ‹åˆ°ç›®æ ‡è¿›å…¥ç›‘æŽ§åŒºåŸŸæ—¶ï¼Œå³ä¾§ **"æŠ¥è­¦è®°å½•"** é¢æ¿ä¼šå®žæ—¶æ˜¾ç¤ºæŠ¥è­¦ä¿¡æ¯
- æŠ¥è­¦ä¿¡æ¯åŒ…æ‹¬ï¼šæ—¶é—´ã€ç›®æ ‡ç±»åˆ«ã€ç›®æ ‡ IDã€ä½ç½®åæ ‡
- æŠ¥è­¦è¡Œä¸ºç”±æŠ¥è­¦è®¾ç½®æŽ§åˆ¶ï¼š
  - **é˜²æŠ–æ—¶é—´**ï¼šåŒä¸€ç›®æ ‡åœ¨è®¾å®šæ—¶é—´å†…åªæŠ¥è­¦ä¸€æ¬¡ï¼ˆé»˜è®¤5ç§’ï¼‰
  - **æ£€æµ‹æ¨¡å¼**ï¼šå¯é€‰æ‹©ä¸­å¿ƒç‚¹æ¨¡å¼æˆ–è¾¹æ¡†æ¨¡å¼
  - **ç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡**ï¼šå¯ç”¨åŽï¼ŒåŒä¸€IDåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªæŠ¥è­¦ä¸€æ¬¡

#### 5. æŸ¥çœ‹æ£€æµ‹ä¿¡æ¯

- å³ä¾§ **"æ£€æµ‹ä¿¡æ¯"** é¢æ¿æ˜¾ç¤ºå½“å‰æ£€æµ‹åˆ°çš„ç›®æ ‡ä¿¡æ¯
- åŒ…æ‹¬ç›®æ ‡ç±»åˆ«ã€ç›®æ ‡ IDã€ç½®ä¿¡åº¦ã€ä½ç½®åæ ‡
- åœ¨ç›‘æŽ§åŒºåŸŸå†…çš„ç›®æ ‡ä¼šç”¨çº¢è‰²æ ‡è®°æ˜¾ç¤º

#### 6. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—

- å³ä¾§ **"ç³»ç»Ÿæ—¥å¿—"** é¢æ¿å®žæ—¶æ˜¾ç¤ºç³»ç»Ÿæ—¥å¿—å’ŒYOLOæŽ¨ç†æ—¥å¿—
- æ—¥å¿—æŒ‰çº§åˆ«å’Œæ¥æºç”¨ä¸åŒé¢œè‰²åŒºåˆ†
- æ”¯æŒè‡ªåŠ¨æ»šåŠ¨å’Œæ‰‹åŠ¨æ¸…ç©ºæ—¥å¿—
- æ‰€æœ‰æ—¥å¿—åŒæ—¶ä¿å­˜åˆ° `logs/` ç›®å½•

## API æŽ¥å£

### REST API

#### èŽ·å–å¤šè¾¹å½¢åŒºåŸŸ
```http
GET /api/polygon
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "polygon": [[100, 200], [300, 200], [300, 400], [100, 400]],
  "defined": true
}
```

#### è®¾ç½®å¤šè¾¹å½¢åŒºåŸŸ
```http
POST /api/polygon
Content-Type: application/json

{
  "polygon": [[100, 200], [300, 200], [300, 400], [100, 400]]
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "message": "å¤šè¾¹å½¢åŒºåŸŸå·²è®¾ç½®"
}
```

#### æ¸…é™¤å¤šè¾¹å½¢åŒºåŸŸ
```http
DELETE /api/polygon
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "message": "å¤šè¾¹å½¢åŒºåŸŸå·²æ¸…é™¤"
}
```

#### èŽ·å–ç³»ç»ŸçŠ¶æ€
```http
GET /api/status
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "video_connected": true,
  "polygon_defined": true,
  "polygon_points_count": 4,
  "current_model": "yolo26m_640_int8.engine",
  "video_url": "rtsp://...",
  "gpu_available": true,
  "device": "0"
}
```

**å­—æ®µè¯´æ˜Ž**ï¼š
- `gpu_available`: GPUæ˜¯å¦å¯ç”¨
- `device`: ä½¿ç”¨çš„è®¾å¤‡ï¼ˆ"0"è¡¨ç¤ºGPUï¼Œ0è¡¨ç¤ºç¬¬ä¸€ä¸ªGPUï¼Œ"cpu"è¡¨ç¤ºCPUï¼‰

#### èŽ·å–æ¨¡åž‹åˆ—è¡¨
```http
GET /api/models
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "models": [
    {
      "name": "yolo11n_640.engine",
      "size": 12345678,
      "size_mb": 11.78,
      "current": false
    }
  ],
  "current": "yolo26m_640_int8.engine"
}
```

#### åˆ‡æ¢æ¨¡åž‹
```http
POST /api/model
Content-Type: application/json

{
  "model": "yolo11n_640.engine"
}
```

#### èŽ·å–/è®¾ç½®è§†é¢‘URL
```http
GET /api/video
POST /api/video
Content-Type: application/json

{
  "video_url": "rtsp://admin:password@192.168.1.2:554/stream"
}
```

#### èŽ·å–ç±»åˆ«åˆ—è¡¨
```http
GET /api/classes
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "classes": [
    {
      "id": 0,
      "name_en": "person",
      "name_cn": "äºº",
      "enabled": true,
      "custom": false,
      "confidence_threshold": 0.25
    }
  ],
  "enabled_classes": [0],
  "custom_names": {},
  "confidence_thresholds": {},
  "total_classes": 80
}
```

#### è®¾ç½®å¯ç”¨çš„ç±»åˆ«
```http
POST /api/classes/enabled
Content-Type: application/json

{
  "enabled_classes": [0, 2, 5]
}
```

#### è®¾ç½®è‡ªå®šä¹‰ä¸­æ–‡åç§°
```http
POST /api/classes/custom-name
Content-Type: application/json

{
  "class_id": 0,
  "custom_name": "äººå‘˜"
}
```

#### è®¾ç½®ç½®ä¿¡åº¦é˜ˆå€¼
```http
POST /api/classes/confidence
Content-Type: application/json

{
  "class_id": 0,
  "confidence_threshold": 0.5
}
```

#### èŽ·å–/è®¾ç½®æ˜¾ç¤ºé…ç½®
```http
GET /api/display
POST /api/display
Content-Type: application/json

{
  "font_size": 20,
  "box_color": [0, 255, 0],
  "box_thickness": 3,
  "text_color": [255, 255, 255],
  "use_chinese": true
}
```

**å‚æ•°è¯´æ˜Ž**ï¼š
- `font_size`: å­—ä½“å¤§å°ï¼ˆ8-72ï¼‰
- `box_color`: è¾¹æ¡†é¢œè‰²ï¼ŒBGRæ ¼å¼ [B, G, R]
- `box_thickness`: è¾¹æ¡†ç²—ç»†ï¼ˆ1-10ï¼‰
- `text_color`: æ–‡å­—é¢œè‰²ï¼ŒRGBæ ¼å¼ [R, G, B]
- `use_chinese`: æ˜¯å¦ä½¿ç”¨ä¸­æ–‡æ˜¾ç¤ºï¼ˆtrue=ä¸­æ–‡ï¼Œfalse=è‹±æ–‡ï¼Œè‹±æ–‡æ¨¡å¼æ€§èƒ½æ›´å¥½ï¼‰

#### èŽ·å–/è®¾ç½®æ¨¡åž‹ç±»åˆ«æ˜ å°„
```http
GET /api/model-classes
POST /api/model-classes
Content-Type: application/json

{
  "model_name": "yolo11n_640.engine",
  "classes_en": ["person", "car", ...],
  "classes_cn": ["äºº", "æ±½è½¦", ...]
}
```

#### èŽ·å–/è®¾ç½®æŠ¥è­¦é…ç½®
```http
GET /api/alarm
POST /api/alarm
Content-Type: application/json

{
  "debounce_time": 5.0,
  "detection_mode": "center",
  "once_per_id": false
}
```

**å‚æ•°è¯´æ˜Ž**ï¼š
- `debounce_time`: é˜²æŠ–æ—¶é—´ï¼ˆç§’ï¼‰ï¼ŒåŒä¸€ç›®æ ‡åœ¨æ­¤æ—¶é—´å†…åªæŠ¥è­¦ä¸€æ¬¡ï¼ŒèŒƒå›´0-300ï¼Œ0è¡¨ç¤ºä¸é˜²æŠ–
- `detection_mode`: æ£€æµ‹æ¨¡å¼ï¼Œ`"center"`=ä¸­å¿ƒç‚¹æ¨¡å¼ï¼Œ`"edge"`=è¾¹æ¡†æ¨¡å¼
- `once_per_id`: ç›¸åŒIDæ˜¯å¦åªæŠ¥è­¦ä¸€æ¬¡ï¼Œ`true`=æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåªæŠ¥è­¦ä¸€æ¬¡ï¼Œ`false`=å…è®¸é‡å¤æŠ¥è­¦ï¼ˆå—é˜²æŠ–æ—¶é—´é™åˆ¶ï¼‰

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "message": "æŠ¥è­¦é…ç½®å·²æ›´æ–°",
  "config": {
    "debounce_time": 5.0,
    "detection_mode": "center",
    "once_per_id": false
  }
}
```

### WebSocket äº‹ä»¶

#### å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨

- `connect`ï¼šè¿žæŽ¥æœåŠ¡å™¨
- `disconnect`ï¼šæ–­å¼€è¿žæŽ¥

#### æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯

- `connected`ï¼šè¿žæŽ¥æˆåŠŸç¡®è®¤
- `frame`ï¼šè§†é¢‘å¸§å’Œæ£€æµ‹ç»“æžœ
  ```json
  {
    "frame": "data:image/jpeg;base64,...",
    "polygon": [[100, 200], [300, 200], [300, 400], [100, 400]],
    "fps": 30.5,
    "resolution": {
      "width": 1920,
      "height": 1080
    },
    "detections": [
      {
        "id": 1,
        "class_id": 0,
        "class_name": "person",
        "class_name_cn": "äºº",
        "bbox": [150, 250, 200, 350],
        "center": {"x": 175, "y": 300},
        "confidence": 0.95,
        "in_zone": true
      }
    ]
  }
  ```
- `log`ï¼šç³»ç»Ÿæ—¥å¿—
  ```json
  {
    "timestamp": "2024-01-01 12:00:00",
    "level": "INFO",
    "logger": "backend",
    "message": "æ¨¡åž‹å·²åŠ è½½: yolo11n_640.engine (å°†ä½¿ç”¨GPUæ¨¡å¼)"
  }
  ```
- `alarm`ï¼šæŠ¥è­¦ä¿¡æ¯
  ```json
  {
    "time": "2024-01-01 12:00:00",
    "track_id": 1,
    "class_id": 0,
    "class_name_cn": "äºº",
    "object_name": "äºº",
    "position": {"x": 175, "y": 300}
  }
  ```

## é¡¹ç›®ç»“æž„

```
yzkj/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ server.py              # Flask åŽç«¯æœåŠ¡
â”œâ”€â”€ frontend/                   # å‰ç«¯æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html              # ä¸»é¡µé¢
â”‚   â””â”€â”€ static/
â”‚       â”œâ”€â”€ css/
â”‚       â”‚   â””â”€â”€ style.css       # æ ·å¼æ–‡ä»¶
â”‚       â””â”€â”€ js/
â”‚           â””â”€â”€ main.js         # å‰ç«¯é€»è¾‘
â”œâ”€â”€ models/                     # YOLOæ¨¡åž‹ç›®å½•
â”‚   â”œâ”€â”€ yolo11n_640.engine
â”‚   â””â”€â”€ yolo26m_640_int8.engine
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ polygon_zone.json       # å¤šè¾¹å½¢åŒºåŸŸé…ç½®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ system_config.json      # ç³»ç»Ÿé…ç½®ï¼ˆæ¨¡åž‹ã€è§†é¢‘URLï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ classes_config.json     # ç±»åˆ«é…ç½®ï¼ˆå¯ç”¨ç±»åˆ«ã€è‡ªå®šä¹‰åç§°ã€ç½®ä¿¡åº¦ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ display_config.json     # æ˜¾ç¤ºé…ç½®ï¼ˆå­—ä½“ã€é¢œè‰²ç­‰ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ model_classes.json      # æ¨¡åž‹ç±»åˆ«æ˜ å°„é…ç½®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ alarm_config.json       # æŠ¥è­¦é…ç½®ï¼ˆé˜²æŠ–æ—¶é—´ã€æ£€æµ‹æ¨¡å¼ç­‰ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ logs/                       # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ backend.log             # åŽç«¯ç³»ç»Ÿæ—¥å¿—
â”‚   â””â”€â”€ yolo.log                # YOLOæŽ¨ç†æ—¥å¿—
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”œâ”€â”€ start_server.sh             # å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md                   # æœ¬æ–‡ä»¶
```

## é…ç½®è¯´æ˜Ž

### é…ç½®æ–‡ä»¶è¯´æ˜Ž

ç³»ç»Ÿä½¿ç”¨å¤šä¸ªJSONé…ç½®æ–‡ä»¶æ¥ä¿å­˜å„ç§è®¾ç½®ï¼Œæ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆï¼š

1. **config/polygon_zone.json** - å¤šè¾¹å½¢ç›‘æŽ§åŒºåŸŸé…ç½®
   ```json
   {
     "polygon_points": [
       [100, 200],
       [300, 200],
       [300, 400],
       [100, 400]
     ]
   }
   ```
   åæ ‡å•ä½ä¸ºåƒç´ ï¼Œç›¸å¯¹äºŽåŽŸå§‹è§†é¢‘åˆ†è¾¨çŽ‡ã€‚

2. **config/system_config.json** - ç³»ç»Ÿé…ç½®ï¼ˆæ¨¡åž‹ã€è§†é¢‘URLï¼‰
   ```json
   {
     "model": "yolo26m_640_int8.engine",
     "video_url": "rtsp://admin:password@192.168.1.2:554/stream"
   }
   ```

3. **config/classes_config.json** - ç±»åˆ«é…ç½®
   ```json
   {
     "enabled_classes": [0, 2, 5],
     "custom_names": {
       "0": "äººå‘˜",
       "2": "è½¦è¾†"
     },
     "confidence_thresholds": {
       "0": 0.5,
       "2": 0.6
     }
   }
   ```

4. **config/display_config.json** - æ˜¾ç¤ºé…ç½®
   ```json
   {
     "font_size": 16,
     "box_color": [0, 255, 0],
     "box_thickness": 2,
     "text_color": [0, 0, 0],
     "use_chinese": true
   }
   ```
   æ³¨æ„ï¼š
   - `box_color` ä½¿ç”¨BGRæ ¼å¼ï¼Œ`text_color` ä½¿ç”¨RGBæ ¼å¼
   - `use_chinese`: true=ä¸­æ–‡æ˜¾ç¤ºï¼ˆä½¿ç”¨PILæ¸²æŸ“ï¼‰ï¼Œfalse=è‹±æ–‡æ˜¾ç¤ºï¼ˆä½¿ç”¨OpenCVåŽŸç”Ÿï¼Œæ€§èƒ½æ›´å¥½ï¼‰

5. **config/model_classes.json** - æ¨¡åž‹ç±»åˆ«æ˜ å°„é…ç½®
   ```json
   {
     "default": {
       "classes_en": ["person", "bicycle", ...],
       "classes_cn": ["äºº", "è‡ªè¡Œè½¦", ...]
     },
     "yolo11n_640.engine": {
       "classes_en": ["person", "car", ...],
       "classes_cn": ["äºº", "æ±½è½¦", ...]
     }
   }
   ```
   æ¯ä¸ªæ¨¡åž‹å¯ä»¥æœ‰è‡ªå·±çš„ç±»åˆ«æ˜ å°„ï¼Œå¦‚æžœæ¨¡åž‹æ²¡æœ‰é…ç½®ï¼Œä¼šä½¿ç”¨ `default` é…ç½®ã€‚

### æŠ¥è­¦é…ç½®

æŠ¥è­¦é…ç½®ä¿å­˜åœ¨ `config/alarm_config.json`ï¼Œå¯é€šè¿‡å‰ç«¯ç•Œé¢æˆ–APIè¿›è¡Œè®¾ç½®ï¼š

```json
{
  "debounce_time": 5.0,
  "detection_mode": "center",
  "once_per_id": false
}
```

**é…ç½®è¯´æ˜Ž**ï¼š
- `debounce_time`: é˜²æŠ–æ—¶é—´ï¼ˆç§’ï¼‰ï¼ŒåŒä¸€ç›®æ ‡åœ¨æ­¤æ—¶é—´å†…åªæŠ¥è­¦ä¸€æ¬¡
  - èŒƒå›´ï¼š0-300ç§’
  - 0è¡¨ç¤ºä¸é˜²æŠ–ï¼Œæ¯æ¬¡è¿›å…¥éƒ½æŠ¥è­¦
  - é»˜è®¤å€¼ï¼š5.0ç§’
- `detection_mode`: æ£€æµ‹æ¨¡å¼
  - `"center"`: ä¸­å¿ƒç‚¹æ¨¡å¼ï¼Œæ£€æµ‹æ¡†ä¸­å¿ƒç‚¹è¿›å…¥åŒºåŸŸæ—¶æ‰æŠ¥è­¦ï¼ˆæ›´ä¸¥æ ¼ï¼Œé€‚åˆéœ€è¦ç›®æ ‡å®Œå…¨è¿›å…¥åŒºåŸŸï¼‰
  - `"edge"`: è¾¹æ¡†æ¨¡å¼ï¼Œæ£€æµ‹æ¡†ä»»æ„ç‚¹è¿›å…¥åŒºåŸŸå³æŠ¥è­¦ï¼ˆæ›´æ•æ„Ÿï¼Œæ£€æµ‹æ¡†ä¸€æŽ¥è§¦åŒºåŸŸè¾¹ç•Œå°±æŠ¥è­¦ï¼‰
  - é»˜è®¤å€¼ï¼š`"center"`
- `once_per_id`: ç›¸åŒIDæ˜¯å¦åªæŠ¥è­¦ä¸€æ¬¡
  - `true`: åŒä¸€IDåœ¨æ•´ä¸ªè·Ÿè¸ªç”Ÿå‘½å‘¨æœŸå†…åªæŠ¥è­¦ä¸€æ¬¡ï¼ˆå³ä½¿ç¦»å¼€åŽå†æ¬¡è¿›å…¥ä¹Ÿä¸æŠ¥è­¦ï¼‰
  - `false`: å…è®¸é‡å¤æŠ¥è­¦ï¼Œä½†å—é˜²æŠ–æ—¶é—´é™åˆ¶
  - é»˜è®¤å€¼ï¼š`false`

**æŠ¥è­¦åˆ¤æ–­é€»è¾‘**ï¼š
- **ä¸­å¿ƒç‚¹æ¨¡å¼**ï¼šè®¡ç®—æ£€æµ‹æ¡†çš„ä¸­å¿ƒç‚¹åæ ‡ï¼Œåˆ¤æ–­ä¸­å¿ƒç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢åŒºåŸŸå†…
- **è¾¹æ¡†æ¨¡å¼**ï¼šæ£€æŸ¥æ£€æµ‹æ¡†çš„å››ä¸ªè§’ç‚¹å’Œä¸­å¿ƒç‚¹ï¼Œä»»æ„ä¸€ç‚¹åœ¨å¤šè¾¹å½¢å†…å³è§¦å‘æŠ¥è­¦

**ä½¿ç”¨å»ºè®®**ï¼š
- éœ€è¦æŒç»­ç›‘æŽ§ä½†é¿å…çŸ­æ—¶é—´å†…é‡å¤æŠ¥è­¦ï¼šä½¿ç”¨é˜²æŠ–æ—¶é—´æ¨¡å¼ï¼ˆ`once_per_id = false`ï¼‰
- åªéœ€è¦é¦–æ¬¡è¿›å…¥æŠ¥è­¦ï¼šå¯ç”¨"ç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡"ï¼ˆ`once_per_id = true`ï¼‰
- éœ€è¦æ›´ä¸¥æ ¼çš„è¿›å…¥åˆ¤æ–­ï¼šä½¿ç”¨ä¸­å¿ƒç‚¹æ¨¡å¼ï¼ˆ`detection_mode = "center"`ï¼‰
- éœ€è¦æ›´æ•æ„Ÿçš„æŠ¥è­¦ï¼šä½¿ç”¨è¾¹æ¡†æ¨¡å¼ï¼ˆ`detection_mode = "edge"`ï¼‰

### GPUå’Œæ€§èƒ½è®¾ç½®

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹GPUå¯ç”¨æ€§ï¼š
- å¦‚æžœæ£€æµ‹åˆ°GPUï¼Œè‡ªåŠ¨ä½¿ç”¨GPUæ¨¡å¼
- å¦‚æžœæ²¡æœ‰GPUæˆ–GPUä¸å¯ç”¨ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°CPUæ¨¡å¼
- å¯é€šè¿‡ `/api/status` æŽ¥å£æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„è®¾å¤‡

### æ—¥å¿—ç³»ç»Ÿ

ç³»ç»Ÿæ—¥å¿—åˆ†ä¸ºä¸¤ç±»ï¼š
- **åŽç«¯æ—¥å¿—** (`logs/backend.log`)ï¼šç³»ç»Ÿè¿è¡Œæ—¥å¿—ã€é…ç½®åŠ è½½æ—¥å¿—ç­‰
- **YOLOæŽ¨ç†æ—¥å¿—** (`logs/yolo.log`)ï¼šYOLOæ¨¡åž‹æŽ¨ç†ç›¸å…³çš„æ—¥å¿—

æ‰€æœ‰æ—¥å¿—ï¼š
- è‡ªåŠ¨ä¿å­˜åˆ° `logs/` ç›®å½•
- æ”¯æŒæ—¥å¿—è½®è½¬ï¼ˆæ¯ä¸ªæ–‡ä»¶æœ€å¤§10MBï¼Œä¿ç•™5ä¸ªå¤‡ä»½ï¼‰
- å‰ç«¯å¯å®žæ—¶æŸ¥çœ‹ï¼ˆåœ¨"ç³»ç»Ÿæ—¥å¿—"é¢æ¿ï¼‰
- æŒ‰æ—¥å¿—çº§åˆ«å’Œæ¥æºç”¨ä¸åŒé¢œè‰²åŒºåˆ†

## å¸¸è§é—®é¢˜

### 1. NumPy ç‰ˆæœ¬å…¼å®¹æ€§é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
AttributeError: _ARRAY_API not found
ImportError: numpy.core.multiarray failed to import
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
pip install "numpy>=1.24.0,<2.0.0" --force-reinstall
```

### 2. è§†é¢‘æµè¿žæŽ¥å¤±è´¥

**å¯èƒ½åŽŸå› **ï¼š
- RTSP åœ°å€é”™è¯¯
- ç½‘ç»œè¿žæŽ¥é—®é¢˜
- è§†é¢‘æºä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ RTSP åœ°å€æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç½‘ç»œè¿žæŽ¥æ­£å¸¸
- æŸ¥çœ‹æŽ§åˆ¶å°è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯

### 3. æ£€æµ‹ä¸åˆ°ç›®æ ‡

**å¯èƒ½åŽŸå› **ï¼š
- YOLO æ¨¡åž‹æœªæ­£ç¡®åŠ è½½
- è§†é¢‘åˆ†è¾¨çŽ‡è¿‡ä½Ž
- ç›®æ ‡è·ç¦»è¿‡è¿œ
- ç±»åˆ«æœªå¯ç”¨
- ç½®ä¿¡åº¦é˜ˆå€¼è®¾ç½®è¿‡é«˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤æ¨¡åž‹æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
- æ£€æŸ¥è§†é¢‘æµæ˜¯å¦æ­£å¸¸
- åœ¨å‰ç«¯ç•Œé¢ä¸­æ£€æŸ¥ç±»åˆ«æ˜¯å¦å·²å¯ç”¨
- è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆåœ¨å‰ç«¯ç•Œé¢ä¸­ä¸ºæ¯ä¸ªç±»åˆ«è®¾ç½®ï¼‰
- æ£€æŸ¥æ¨¡åž‹ç±»åˆ«æ˜ å°„æ˜¯å¦æ­£ç¡®

### 4. WebSocket è¿žæŽ¥å¤±è´¥

**å¯èƒ½åŽŸå› **ï¼š
- é˜²ç«å¢™é˜»æ­¢ç«¯å£ 5000
- æœåŠ¡å™¨æœªå¯åŠ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- ç¡®è®¤æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥æµè§ˆå™¨æŽ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯

### 5. ä¸­æ–‡æ˜¾ç¤ºä¹±ç 

**å¯èƒ½åŽŸå› **ï¼š
- ç³»ç»Ÿæœªå®‰è£…ä¸­æ–‡å­—ä½“

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å®‰è£…ä¸­æ–‡å­—ä½“ï¼ˆè§"ä¸­æ–‡å­—ä½“æ”¯æŒ"ç« èŠ‚ï¼‰
- é‡å¯æœåŠ¡å™¨

### 6. æ¨¡åž‹ç±»åˆ«ä¸åŒ¹é…

**å¯èƒ½åŽŸå› **ï¼š
- ä½¿ç”¨çš„æ¨¡åž‹ä¸æ˜¯COCOæ•°æ®é›†è®­ç»ƒçš„
- æ¨¡åž‹ç±»åˆ«æ˜ å°„é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é€šè¿‡APIæˆ–ç›´æŽ¥ç¼–è¾‘ `config/model_classes.json` é…ç½®æ¨¡åž‹ç±»åˆ«æ˜ å°„
- ç¡®ä¿ç±»åˆ«æ•°é‡ä¸Žæ¨¡åž‹è¾“å‡ºä¸€è‡´

### 7. å¸§çŽ‡è¿‡ä½Ž

**å¯èƒ½åŽŸå› **ï¼š
- ä½¿ç”¨ä¸­æ–‡æ˜¾ç¤ºæ¨¡å¼ï¼ˆPILæ¸²æŸ“æ€§èƒ½è¾ƒä½Žï¼‰
- è§†é¢‘åˆ†è¾¨çŽ‡è¿‡é«˜
- GPUæœªæ­£ç¡®ä½¿ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åˆ‡æ¢åˆ°è‹±æ–‡æ˜¾ç¤ºæ¨¡å¼ï¼ˆæ€§èƒ½æ›´å¥½ï¼Œå¯æå‡æ•°å€å¸§çŽ‡ï¼‰
- é™ä½Žè§†é¢‘åˆ†è¾¨çŽ‡
- æ£€æŸ¥GPUæ˜¯å¦æ­£ç¡®æ£€æµ‹å’Œä½¿ç”¨ï¼ˆæŸ¥çœ‹ç³»ç»ŸçŠ¶æ€APIï¼‰

### 8. æ—¥å¿—ä¸æ˜¾ç¤º

**å¯èƒ½åŽŸå› **ï¼š
- WebSocketè¿žæŽ¥é—®é¢˜
- æ—¥å¿—é˜Ÿåˆ—é˜»å¡ž

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥æµè§ˆå™¨æŽ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- ç¡®è®¤WebSocketè¿žæŽ¥æ­£å¸¸ï¼ˆæŸ¥çœ‹è¿žæŽ¥çŠ¶æ€ï¼‰
- é‡å¯æœåŠ¡

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ä½¿ç”¨ TensorRT å¼•æ“Ž**ï¼šå°†æ¨¡åž‹è½¬æ¢ä¸º `.engine` æ ¼å¼ä»¥èŽ·å¾—æœ€ä½³æ€§èƒ½
2. **ä½¿ç”¨è‹±æ–‡æ˜¾ç¤ºæ¨¡å¼**ï¼šåˆ‡æ¢åˆ°è‹±æ–‡æ˜¾ç¤ºå¯ä»¥æ˜¾è‘—æå‡å¸§çŽ‡ï¼ˆé¿å…PILå›¾åƒè½¬æ¢å¼€é”€ï¼‰
3. **è°ƒæ•´è§†é¢‘åˆ†è¾¨çŽ‡**ï¼šé™ä½Žè§†é¢‘åˆ†è¾¨çŽ‡å¯ä»¥æé«˜å¤„ç†é€Ÿåº¦
4. **GPU åŠ é€Ÿ**ï¼šç¡®ä¿ä½¿ç”¨æ”¯æŒ CUDA çš„ GPUï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹ï¼‰
5. **ç½‘ç»œä¼˜åŒ–**ï¼šå¯¹äºŽ RTSP æµï¼Œç¡®ä¿ç½‘ç»œå¸¦å®½å……è¶³
6. **ç±»åˆ«è¿‡æ»¤**ï¼šåªå¯ç”¨éœ€è¦æ£€æµ‹çš„ç±»åˆ«ï¼Œå‡å°‘å¤„ç†å¼€é”€
7. **ç½®ä¿¡åº¦é˜ˆå€¼**ï¼šåˆç†è®¾ç½®ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œè¿‡æ»¤ä½Žç½®ä¿¡åº¦æ£€æµ‹

## å¼€å‘è¯´æ˜Ž

### é…ç½®æ¨¡åž‹ç±»åˆ«æ˜ å°„

å¦‚æžœä½¿ç”¨éžCOCOæ•°æ®é›†è®­ç»ƒçš„æ¨¡åž‹ï¼Œéœ€è¦é…ç½®å¯¹åº”çš„ç±»åˆ«æ˜ å°„ï¼š

1. **é€šè¿‡APIé…ç½®**ï¼š
   ```bash
   curl -X POST http://localhost:5000/api/model-classes \
     -H "Content-Type: application/json" \
     -d '{
       "model_name": "your_model.engine",
       "classes_en": ["class1", "class2", ...],
       "classes_cn": ["ç±»åˆ«1", "ç±»åˆ«2", ...]
     }'
   ```

2. **ç›´æŽ¥ç¼–è¾‘é…ç½®æ–‡ä»¶**ï¼š
   ç¼–è¾‘ `config/model_classes.json`ï¼Œæ·»åŠ æˆ–ä¿®æ”¹æ¨¡åž‹é…ç½®ï¼š
   ```json
   {
     "your_model.engine": {
       "classes_en": ["class1", "class2", ...],
       "classes_cn": ["ç±»åˆ«1", "ç±»åˆ«2", ...]
     }
   }
   ```

### ç±»åˆ«ç®¡ç†

- åœ¨å‰ç«¯ç•Œé¢ä¸­å¯ä»¥é€‰æ‹©è¦æ£€æµ‹çš„ç±»åˆ«
- å¯ä»¥ä¸ºæ¯ä¸ªç±»åˆ«è®¾ç½®è‡ªå®šä¹‰ä¸­æ–‡åç§°
- å¯ä»¥ä¸ºæ¯ä¸ªç±»åˆ«è®¾ç½®ç‹¬ç«‹çš„ç½®ä¿¡åº¦é˜ˆå€¼
- æ‰€æœ‰é…ç½®ä¼šè‡ªåŠ¨ä¿å­˜åˆ° `config/classes_config.json`

### æ·»åŠ å…¶ä»–æŠ¥è­¦æ–¹å¼

åœ¨ `backend/server.py` çš„ `trigger_alarm` å‡½æ•°ä¸­å¯ä»¥æ·»åŠ ï¼š

- æ’­æ”¾å£°éŸ³
- å‘é€ HTTP è¯·æ±‚
- ä¿å­˜æˆªå›¾
- å‘é€é‚®ä»¶/çŸ­ä¿¡ç­‰

ç¤ºä¾‹ï¼š

```python
def trigger_alarm(track_id, bbox_center, class_id=None, class_name_cn=None):
    # ... çŽ°æœ‰ä»£ç  ...
    
    # ä¿å­˜æˆªå›¾
    if latest_frame is not None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        cv2.imwrite(f"alarm_{timestamp}_id{track_id}.jpg", latest_frame)
    
    # å‘é€ HTTP è¯·æ±‚
    import requests
    requests.post("http://your-api-endpoint", json=alarm_data)
```

### ä¸­æ–‡å­—ä½“æ”¯æŒ

å¦‚æžœè§†é¢‘ç”»é¢ä¸Šçš„ä¸­æ–‡æ˜¾ç¤ºä¸ºæ–¹å—æˆ–ä¹±ç ï¼Œéœ€è¦å®‰è£…ä¸­æ–‡å­—ä½“ï¼š

**Ubuntu/Debian**ï¼š
```bash
sudo apt-get install fonts-wqy-microhei fonts-wqy-zenhei
```

**CentOS/RHEL**ï¼š
```bash
sudo yum install wqy-microhei-fonts wqy-zenhei-fonts
```

å®‰è£…åŽé‡å¯æœåŠ¡å™¨å³å¯æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

## æ›´æ–°æ—¥å¿—

### v2.2.0
- âœ¨ æ·»åŠ æŠ¥è­¦é…ç½®åŠŸèƒ½ï¼ˆå‰ç«¯å¯é…ç½®é˜²æŠ–æ—¶é—´ã€æ£€æµ‹æ¨¡å¼ã€ç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡ï¼‰
- âœ¨ æ”¯æŒä¸¤ç§æ£€æµ‹æ¨¡å¼ï¼šä¸­å¿ƒç‚¹æ¨¡å¼å’Œè¾¹æ¡†æ¨¡å¼
- âœ¨ æ”¯æŒç›¸åŒIDåªæŠ¥è­¦ä¸€æ¬¡é€‰é¡¹ï¼ˆæ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªæŠ¥è­¦ä¸€æ¬¡ï¼‰
- ðŸ› ä¿®å¤stream=Trueæ¨¡å¼ä¸‹çš„ç»“æžœå¤„ç†é—®é¢˜
- ðŸ“ å®Œå–„READMEæ–‡æ¡£ï¼Œæ·»åŠ æŠ¥è­¦é…ç½®è¯¦ç»†è¯´æ˜Ž

### v2.1.0
- âœ¨ æ·»åŠ GPUè‡ªåŠ¨æ£€æµ‹åŠŸèƒ½ï¼Œæ— GPUæ—¶è‡ªåŠ¨ä½¿ç”¨CPU
- âœ¨ æ·»åŠ å®žæ—¶å¸§çŽ‡å’Œåˆ†è¾¨çŽ‡æ˜¾ç¤º
- âœ¨ æ·»åŠ ä¸­è‹±æ–‡æ˜¾ç¤ºåˆ‡æ¢åŠŸèƒ½ï¼ˆè‹±æ–‡æ¨¡å¼æ€§èƒ½æ›´ä¼˜ï¼‰
- âœ¨ æ·»åŠ æ—¥å¿—ç³»ç»Ÿï¼ˆåŽç«¯æ—¥å¿—å’ŒYOLOæŽ¨ç†æ—¥å¿—åˆ†ç¦»ï¼‰
- âœ¨ å‰ç«¯å®žæ—¶æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
- ðŸ“ é…ç½®æ–‡ä»¶ç»Ÿä¸€ç®¡ç†åˆ°configç›®å½•
- ðŸ› ä¿®å¤FPSè®¡ç®—é—®é¢˜
- ðŸŽ¨ ä¼˜åŒ–æ—¥å¿—æ˜¾ç¤ºç•Œé¢

### v2.0.0
- âœ¨ æ”¯æŒå¤šç±»åˆ«æ£€æµ‹ï¼ˆ80ä¸ªCOCOç±»åˆ«ï¼‰
- âœ¨ æ”¯æŒæ¨¡åž‹åŠ¨æ€åˆ‡æ¢
- âœ¨ æ”¯æŒè§†é¢‘æºåŠ¨æ€åˆ‡æ¢
- âœ¨ æ”¯æŒç±»åˆ«é€‰æ‹©å’Œç®¡ç†
- âœ¨ æ”¯æŒè‡ªå®šä¹‰ä¸­æ–‡åç§°
- âœ¨ æ”¯æŒè‡ªå®šä¹‰ç½®ä¿¡åº¦é˜ˆå€¼
- âœ¨ æ”¯æŒæ˜¾ç¤ºæ ·å¼å®šåˆ¶ï¼ˆå­—ä½“ã€é¢œè‰²ç­‰ï¼‰
- âœ¨ æ”¯æŒæ¨¡åž‹ç±»åˆ«æ˜ å°„é…ç½®
- ðŸ› ä¿®å¤ä¸­æ–‡æ˜¾ç¤ºä¹±ç é—®é¢˜
- ðŸŽ¨ ä¼˜åŒ–ç”¨æˆ·ç•Œé¢

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒå®žæ—¶äººå‘˜æ£€æµ‹
- æ”¯æŒè‡ªå®šä¹‰å¤šè¾¹å½¢ç›‘æŽ§åŒºåŸŸ
- æ”¯æŒ Web ç•Œé¢æ“ä½œ
- æ”¯æŒæŠ¥è­¦åŠŸèƒ½

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»å¼€å‘è€…ã€‚

